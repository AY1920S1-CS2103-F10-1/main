<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.6.1"><title>Model</title><link rel="stylesheet" href="./gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css"></head><body class="article"><div id="site-header"><nav class="navbar navbar-light bg-light"><div class="container"><a class="navbar-brand" href="../index.html">NurseTraverse</a><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../UserGuide.html">User Guide</a></li><li class="nav-item"><a class="nav-link" href="../DeveloperGuide.html">Developer Guide</a></li><li class="nav-item"><a class="nav-link" href="../AboutUs.html">About Us</a></li><li class="nav-item"><a class="nav-link" href="../ContactUs.html">Contact Us</a></li><li class="navitem"><a class="nav-link" href="https://github.com/AY1920S1-CS2103-F10-1/main"><span class="fa fa-github fa-lg" aria-hidden="true"></span>&nbsp;View on GitHub</a></li></ul></div></nav></div><div id="header"></div><div id="content"><div class="paragraph">
<p>Visit Management has 3 sections to it: the model that models the visits, the logic that allows users to manipulate these models and the UI.</p>
</div>
<div class="sect3">
<h4 id="model"><a class="link" href="#model">Model</a></h4>
<div class="paragraph">
<p>How Visits, VisitTodos and VisitTasks are stored can be seen in <a href="#Design-Model">[Design-Model]</a> above. To support the feature of ongoing visits and the constraint that there can only be 1 ongoing visit at a time, a <code>Pair&lt;Integer, Integer&gt;</code> named <code>pairOfOngoingPatAndVisitIndexes</code> is stored in <code>PatientBook</code>. This serves multiple purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To identify the <code>Patient</code> that is currently being visited and the <code>Visit</code> that is ongoing</p>
</li>
<li>
<p>To ensure that the state is saved even if the application shuts down during an ongoing visit</p>
</li>
<li>
<p>To ensure there is no duplication of data by storing only the indexes for reference</p>
</li>
<li>
<p>Although there is a reference to the <code>Patient</code> in the <code>Visit</code> class, this reference is only implied in the JSON file. To maximize efficiency such that the application does not have to search every patient to find an ongoing visit every time the application is opened, the <code>Patient</code> needs to be stored together with the <code>Visit</code> as a pair in <code>PatientBook</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Model</code> implements the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Model#setNewOngoingVisit(Visit visit)</code>&#8201;&#8212;&#8201;Record a new ongoing <code>Visit</code> of person in the model. This <code>Visit</code> must be retrieved unmodified from a <code>Patient</code>, or an <code>IllegalArgumentException</code> will be thrown (so only use this to begin visits).</p>
</li>
<li>
<p><code>Model#updateOngoingVisit(Visit updatedVisit)</code>&#8201;&#8212;&#8201;Update an ongoing <code>Visit</code> in the model. This will update the ongoing <code>Visit</code> and update the <code>Visit</code> in the <code>Patient</code>. Use this to update an ongoing <code>Visit</code> when there is already a <code>Visit</code>.</p>
</li>
<li>
<p><code>Model#unsetOngoingVisit()</code>&#8201;&#8212;&#8201;Set the ongoing visit of person in the model and patient book to null (for cancelling or deleting visits).</p>
</li>
<li>
<p><code>Model#patientHasOngoingVisit(Person person)</code>&#8201;&#8212;&#8201;Returns true if the person has an ongoing visit.</p>
</li>
<li>
<p><code>Model#getObservableOngoingVisitList()</code>&#8201;&#8212;&#8201;Returns a <code>ObservableList&lt;Visit&gt;</code> containing the ongoing <code>Visit</code> if there is an ongoing <code>Visit</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="model-design-considerations"><a class="link" href="#model-design-considerations">Model Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-how-to-reflect-changes-in-ongoing-visit-on-ui"><a class="link" href="#aspect-how-to-reflect-changes-in-ongoing-visit-on-ui">Aspect: How to reflect changes in ongoing visit on UI</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Use an <code>ObservableList&lt;Visit&gt;</code> returned from <code>FXCollections.observableArrayList()</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easier to implement.</p>
</li>
<li>
<p>Cons: May not make logical sense as there will only be 0..1 ongoing <code>Visit</code> s at any point in time.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Manually trigger an update every time the ongoing <code>Visit</code> is updated.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Makes logical sense as there will only be 0..1 ongoing <code>Visit</code> s at any point in time.</p>
</li>
<li>
<p>Cons: Complex, increased coupling between UI and Model. These lead to an increase of work (and potentially errors) for the developer.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="logic"><a class="link" href="#logic">Logic</a></h4>

</div>
<div class="sect3">
<h4 id="logic-design-considerations"><a class="link" href="#logic-design-considerations">Logic Design Considerations</a></h4>

</div>
<div class="sect3">
<h4 id="ui"><a class="link" href="#ui">UI</a></h4>
<div class="paragraph">
<p>A <code>Patient</code> 's <code>Visit</code> s, <code>VisitTodo</code> are displayed together with his details on <code>pat-list</code> and <code>pat-find</code> in a <code>TitledPane</code>.</p>
</div>
<div class="paragraph">
<p>An ongoing <code>Visit</code> is displayed in another tab named "Current Visit" using  <code>OngoingVisitListPanel</code> containing <code>OngoingVisitCard</code> which contains <code>VisitTaskTableView</code>. Likewise, <code>pat-list</code> and <code>pat-find</code> use <code>FinishedVisitCard</code> s each containing a <code>VisitTaskTableView</code> to display the <code>Visit</code> s and <code>VisitTask</code> s.</p>
</div>
<div class="sect4">
<h5 id="changing-of-tabs-on-running-the-appropriate-command"><a class="link" href="#changing-of-tabs-on-running-the-appropriate-command">Changing of tabs on running the appropriate command</a></h5>
<div class="paragraph">
<p>The application currently does not change tabs when an appropriate command is run (e.g. if you&#8217;re on the Patient tab and you run visit-now-update, it will stay on the Patient tab). This is actually by design as it allows users to multitask across tabs.</p>
</div>
<div class="paragraph">
<p>If in future iterations there is a need to change the tab on running an appropriate command, there are some considerations on how to implement the changing of tabs programmatically (e.g. when someone executes the command to begin a visit), which necessitates some additional coupling between <code>Model</code> and <code>Ui</code>. The proposed implementation may be to use the Observer pattern: <code>Model</code> would contain a subject that would notify its observers whenever a component (e.g. <code>Patient</code> or <code>Visit</code>) is listed/added/updated/deleted/etc, and <code>Ui</code> could observer this subject and update itself accordingly.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ui-design-considerations"><a class="link" href="#ui-design-considerations">UI Design Considerations</a></h4>
<div class="paragraph">
<p>Aspect: How to display the <code>Patient</code> 's <code>Visit</code> records (and his <code>VisitTodo</code> s)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Embed it with <code>pat-list</code> and <code>pat-find</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easier to implement, convenient for user (don&#8217;t have to call methods such as <code>visit-view</code> which will only show the visit)</p>
</li>
<li>
<p>Cons: May clutter screen.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Implement functions such as <code>visit-view</code> etc.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: A cleaner result page from <code>pat-list</code> and <code>pat-find</code>.</p>
</li>
<li>
<p>Cons: Increased developer work and user will have to use multiple commands to view the <code>Patient</code> 's <code>Visit</code> data.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Aspect: How to display the ongoing <code>Visit</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Put the <code>PersonListPanel</code> into a <code>TabPane</code> and put the <code>OngoingVisitListPanel</code> in the same <code>TabPane</code></p>
<div class="ulist">
<ul>
<li>
<p>Pros: Neater.</p>
</li>
<li>
<p>Cons: No real cons apart from the fact that the user will have to click to change tabs.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Open a new window to show the ongoing <code>Visit</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Can be viewed side by side with the main application.</p>
</li>
<li>
<p>Cons: Increases clutter on user screen, increases complexity in handling scenario where user closes the window.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="use-case"><a class="link" href="#use-case">Use case</a></h4>
<div class="paragraph">
<p>Visit Management is used when the user wants to visit a patient and record their visit. There are 4 actions that a user can perform:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="VisitManagementUseCase.png" alt="VisitManagementUseCase">
</div>
</div>
<div class="paragraph">
<p>The possible workflow a user can take when these set of actions is depicted in the following diagram. Take note that the application will always start without an ongoing visit and this assumption is implied in the activity diagram. Also note that the terms "visit" and "ongoing visit" are interchangeable, as a user can only cancel, update or finish an ongoing visit.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="VisitActivityDiagram.png" alt="VisitActivityDiagram" width="600">
</div>
</div>
<div class="paragraph">
<p>The most complex part of this use case is in when the user decides to update the ongoing visit. The sequence of events when updating an ongoing visit is detailed in this <a href="images/UpdateOngoingVisitSequenceDiagram.png">sequence diagram</a>. Note that this sequence diagram is <em>not</em> exhaustive to help you understand without going into too much detail. (e.g. Exception handling is omitted and in-depth code is placed into ref fragments which are not included in this developer guide).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="UpdateOngoingVisitSequenceDiagram.png" alt="UpdateOngoingVisitSequenceDiagram">
</div>
</div>
</div></div><div id="footer"><div class="container"><div id="footer-text">Last updated 2019-11-11 15:05:30 UTC</div></div></div></body></html>